<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‚¡ç¥¨åŸºæœ¬é¢ AI åˆ†æå™¨ ğŸ“ˆ</title>
  <meta name="description" content="åŸºäº DeepSeek æ·±åº¦æ€è€ƒæ¨¡å¼çš„è‚¡ç¥¨åŸºæœ¬é¢åˆ†æå·¥å…·">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“ˆ</text></svg>">
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .glass { background: rgba(30, 41, 59, 0.6); backdrop-filter: blur(12px); }
    .spin { animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .pulse { animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen">
  <div id="app">
    <!-- Header -->
    <header class="py-8 px-4 text-center">
      <h1 class="text-3xl font-bold text-white mb-2">ğŸ“ˆ è‚¡ç¥¨åŸºæœ¬é¢ AI åˆ†æå™¨</h1>
      <p class="text-slate-400 text-sm">åŸºäº DeepSeek æ·±åº¦æ€è€ƒæ¨¡å¼çš„ä¸“ä¸šåˆ†æ</p>
    </header>

    <!-- Main -->
    <main class="container mx-auto px-4 pb-12">
      <!-- Input Card -->
      <div class="max-w-2xl mx-auto bg-slate-800/60 backdrop-blur rounded-2xl p-6 border border-slate-700/50">
        <label class="block text-white font-medium mb-3">è‚¡ç¥¨åç§°æˆ–ä»£ç </label>
        <div class="flex gap-3">
          <input
            v-model="stockCode"
            type="text"
            placeholder="ä¾‹å¦‚ï¼šä¸œé¹ç‰¹é¥®ã€605499ã€è…¾è®¯ã€è´µå·èŒ…å°"
            class="flex-1 px-4 py-3 bg-slate-700/60 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:border-indigo-500 outline-none transition"
            :disabled="loading"
            @keyup.enter="analyze"
          >
          <button
            @click="analyze"
            :disabled="!canSubmit || loading"
            class="px-6 py-3 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-600 text-white font-medium rounded-xl transition flex items-center gap-2"
          >
            <span v-if="loading" class="spin">â³</span>
            <span>{{ loading ? 'åˆ†æä¸­...' : 'å¼€å§‹åˆ†æ' }}</span>
          </button>
        </div>
        <div class="mt-4 flex flex-wrap gap-2">
          <span class="text-slate-500 text-sm">å¿«æ·ï¼š</span>
          <button v-for="s in examples" :key="s" @click="stockCode = s"
            class="px-3 py-1 bg-slate-700/60 hover:bg-slate-700 text-slate-300 hover:text-white rounded-lg text-sm transition"
            :disabled="loading">{{ s }}</button>
        </div>
      </div>

      <!-- Loading -->
      <div v-if="loading" class="max-w-2xl mx-auto mt-8 bg-slate-800/60 backdrop-blur rounded-2xl p-8 border border-slate-700/50 text-center">
        <div class="inline-flex items-center justify-center w-20 h-20 mb-6">
          <div class="relative">
            <div class="absolute inset-0 border-4 border-indigo-500/30 rounded-full"></div>
            <div class="absolute inset-0 border-4 border-indigo-500 rounded-full border-t-transparent spin"></div>
            <span class="text-3xl">ğŸ¤–</span>
          </div>
        </div>
        <h3 class="text-white text-lg font-medium mb-2">DeepSeek æ·±åº¦æ€è€ƒä¸­...</h3>
        <p class="text-slate-400 text-sm">æ­£åœ¨åˆ†æ {{ stockCode }} çš„åŸºæœ¬é¢</p>
        <div class="max-w-xs mx-auto mt-4">
          <div class="h-1 bg-slate-700 rounded-full overflow-hidden">
            <div class="h-full bg-indigo-500 pulse" style="width: 60%"></div>
          </div>
        </div>
      </div>

      <!-- Error -->
      <div v-if="error" class="max-w-2xl mx-auto mt-6 p-4 bg-red-500/10 border border-red-500/30 rounded-xl text-red-400 text-center">
        {{ error }}
      </div>

      <!-- Result -->
      <div v-if="result" class="max-w-4xl mx-auto mt-8 bg-slate-800/60 backdrop-blur rounded-2xl border border-slate-700/50 overflow-hidden">
        <div class="px-6 py-4 bg-slate-700/30 border-b border-slate-700/50 flex justify-between items-center">
          <h2 class="text-white font-semibold">ğŸ“Š {{ result.stock }} åˆ†ææŠ¥å‘Š</h2>
          <button @click="copyResult" class="px-3 py-1 bg-slate-600 hover:bg-slate-500 text-slate-300 hover:text-white rounded-lg text-sm transition">
            {{ copied ? 'âœ… å·²å¤åˆ¶' : 'ğŸ“‹ å¤åˆ¶' }}
          </button>
        </div>
        <div class="p-6 text-slate-300 leading-relaxed whitespace-pre-wrap">{{ result.analysis }}</div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="py-6 text-center text-slate-500 text-sm">
      <p>è¾“å…¥è‚¡ç¥¨åç§°æˆ–ä»£ç ï¼Œè·å–å®Œæ•´åŸºæœ¬é¢åˆ†ææŠ¥å‘Š</p>
    </footer>
  </div>

  <script>
    const { createApp, ref, computed } = Vue
    const API_URL = 'https://stock-ai-analyzer.tudou7758.workers.dev/api'
    // å¤‡ç”¨ï¼šå¦‚æœ Worker è¿˜æ²¡éƒ¨ç½²ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
    const DEMO_MODE = false

    createApp({
      setup() {
        const stockCode = ref('')
        const result = ref(null)
        const loading = ref(false)
        const error = ref(null)
        const copied = ref(false)
        const examples = ['ä¸œé¹ç‰¹é¥®', 'è…¾è®¯', 'è´µå·èŒ…å°', 'å®å¾·æ—¶ä»£']

        const canSubmit = computed(() => stockCode.value.trim().length >= 1)

        const analyze = async () => {
          if (!canSubmit.value || loading.value) return
          stockCode.value = stockCode.value.trim()
          result.value = null
          error.value = null
          loading.value = true

          try {
            if (DEMO_MODE) {
              await new Promise(r => setTimeout(r, 2000))
              result.value = { stock: stockCode.value, analysis: demoResponse(stockCode.value) }
            } else {
              const res = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ stock: stockCode.value })
              })
              const data = await res.json()
              if (data.success) result.value = data.data
              else error.value = data.error || 'åˆ†æå¤±è´¥'
            }
          } catch (e) {
            error.value = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'
          } finally {
            loading.value = false
          }
        }

        const copyResult = async () => {
          try {
            await navigator.clipboard.writeText(result.value.analysis)
            copied.value = true
            setTimeout(() => copied.value = false, 2000)
          } catch (e) {}
        }

        return { stockCode, result, loading, error, copied, examples, canSubmit, analyze, copyResult }
      }
    }).mount('#app')

    function demoResponse(stock) {
      return `# ${stock} åŸºæœ¬é¢åˆ†ææŠ¥å‘Š

## ä¸€ã€åŸºç¡€æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å¸‚å€¼ | å¾…è·å– | æ•°æ®ä¸å¯å¾— |
| PE(TTM) | å¾…è·å– | æ•°æ®ä¸å¯å¾— |
| PB | å¾…è·å– | æ•°æ®ä¸å¯å¾— |

> âš ï¸ æ³¨æ„ï¼šè¿™æ˜¯æ¼”ç¤ºæ¨¡å¼ï¼Œå®Œæ•´åˆ†æéœ€è¦éƒ¨ç½²åç«¯ APIã€‚

## äºŒã€æç¤ºè¯æ¡†æ¶å·²å°±ç»ª

æœ¬åˆ†æå™¨ä½¿ç”¨ä»¥ä¸‹ç»“æ„åŒ–åˆ†ææ¡†æ¶ï¼š

1. **åŸºç¡€æ•°æ®å‡†å¤‡** - å¸‚å€¼ã€PE/PBã€è¡Œä¸šå¯¹æ¯”
2. **ä¼°å€¼åˆ†ä½åˆ†æ** - 5å¹´/10å¹´ä¸­å€¼åç¦»åº¦
3. **ä¸šåŠ¡åˆ†æ** - æ ¸å¿ƒäº§å“ã€å‘¨æœŸå±æ€§ã€æŠ¤åŸæ²³
4. **ç»è¥ç¨³å®šæ€§** - å‘å±•é˜¶æ®µã€åˆ©æ¶¦æ³¢åŠ¨
5. **å®šä»·æƒåˆ†æ** - å¼ºå¼±å®šä»·é¢†åŸŸåˆ¤æ–­
6. **æˆé•¿æ€§åˆ†æ** - å†å²å½’å› ã€æœªæ¥é¢„æµ‹
7. **è´¢åŠ¡è´¨é‡** - ç°é‡‘æµã€å•†èª‰é£é™©
8. **ç«äº‰æ ¼å±€** - æ³¢ç‰¹äº”åŠ›åˆ†æ
9. **ç»¼åˆä¼°å€¼** - å¤šæ¨¡å‹ä¼°å€¼ã€å®‰å…¨è¾¹é™…

## ä¸‰ã€éƒ¨ç½²è¯´æ˜

### åç«¯ API é…ç½®

éœ€è¦éƒ¨ç½² Cloudflare Workers å¹¶é…ç½® DeepSeek API Keyï¼š

\`\`\`bash
# å®‰è£… wrangler
npm install -g wrangler

# é…ç½® API Key
npx wrangler secret put DEEPSEEK_API_KEY

# éƒ¨ç½²
npx wrangler deploy
\`\`\`

### ç¯å¢ƒå˜é‡

åœ¨ Cloudflare Dashboard ä¸­è®¾ç½®ï¼š
- \`DEEPSEEK_API_KEY\`: ä½ çš„ DeepSeek API Key
- \`DEEPSEEK_MODEL\`: deepseek-reasoner (å¯é€‰)

---

*éƒ¨ç½²å®Œæˆåï¼ŒAI å°†è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„åŸºæœ¬é¢åˆ†ææŠ¥å‘Šã€‚*`
    }
  </script>
</body>
</html>
